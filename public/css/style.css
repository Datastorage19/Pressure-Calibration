:root{
  --brand:#1b8f3a; --ink:#0f172a; --muted:#64748b; --bg:#f5f7f5; --card:#ffffff; --line:#dbe7d9;
  --pass:#16a34a; --fail:#dc2626; --warn:#f59e0b; --page:1200px;
}
*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--ink);font-family:"Sarabun",system-ui,Segoe UI,Tahoma,sans-serif;font-size:16px;line-height:1.5}
.container{max-width:var(--page);margin:0 auto;padding:16px}
.card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:16px}
.grid{display:grid;gap:12px}
.grid-2{grid-template-columns:1fr 1fr}
.grid-3{grid-template-columns:repeat(3,1fr)}
.grid-4{grid-template-columns:repeat(4,1fr)}
.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.row.nowrap{flex-wrap:nowrap;overflow-x:auto}
.row.nowrap>*{flex:0 0 auto}
.row .input{min-width:0}

/* Topbar + Tabs */
.topbar{position:sticky;top:0;z-index:10;background:var(--brand);color:#fff;padding:12px 16px;border-bottom:3px solid #0f4f25}
.top-title{font-weight:700}
.tabs{display:grid;grid-template-columns:repeat(7,minmax(0,1fr));gap:8px;margin-top:10px;white-space:nowrap;overflow-x:auto;scrollbar-width:thin}
.tab{appearance:none;border:0;background:#eaf5ed;color:#0b3819;padding:10px 12px;border-radius:999px;font-weight:700;cursor:pointer;text-align:center;white-space:nowrap}
.tab.active{background:#0b3819;color:#fff}
.tab:focus{outline:2px solid #0b3819}

/* Inputs */
label{font-weight:700; white-space:nowrap}
.input,select,textarea{width:100%;padding:10px 12px;border:1px solid var(--line);border-radius:10px;background:#fff;font-family:inherit}
.input{height:44px;line-height:44px}            /* ให้สูงเท่ากัน */
.row > .input{height:44px;line-height:44px}
.helper{font-size:.9rem;color:var(--muted)}
.btn{background:var(--brand);color:#fff;border:0;padding:10px 14px;border-radius:10px;font-weight:700;cursor:pointer}
.btn.ghost{background:#fff;color:var(--brand);border:1px solid var(--brand)}
.btn.dark{background:#0f172a}
.btn.warn{background:var(--warn)}
.btn.fail{background:var(--fail)}
.small{font-size:.9rem;color:var(--muted)}
.sep{border:0;border-top:1px dashed var(--line);margin:14px 0}

/* KPI cards */
.kpi-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:12px}
.kpi{background:#fff;border:1px solid var(--line);border-radius:16px;padding:14px;display:flex;flex-direction:column;justify-content:center;align-items:flex-start;min-height:98px}
.kpi .n{font-size:1.8rem;font-weight:800}

/* Table */
.table{width:100%;border-collapse:collapse;font-size:.95rem}
.table th,.table td{border-bottom:1px solid #e7efe5;padding:8px 10px;text-align:left;vertical-align:top}
.table th{background:#f2f7f3}
.table input.mcell{caret-color:auto}  /* คลิกครั้งเดียวกรอกได้ */

/* Badges */
.badge{display:inline-block;padding:4px 8px;border-radius:999px;font-size:.85rem;font-weight:800}
.badge.pass{background:#e8f7ee;color:var(--pass);border:1px solid #bfeacc}
.badge.fail{background:#fee2e2;color:var(--fail);border:1px solid #fecaca}

/* Report blocks */
.blk{border:1px solid var(--line);border-radius:12px;padding:12px;background:#fff}
.label{color:#0b3819;font-weight:700;border-bottom:1px solid #e7efe5;padding-bottom:6px;margin-bottom:6px}
.report-head{display:grid;grid-template-columns:2fr 1fr;gap:12px}
.report-grid{display:grid;gap:12px}
.report-3{grid-template-columns:1fr 1fr 1fr}
.report-2{grid-template-columns:1fr 1fr}

/* Env fields */
.env-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;align-items:end}
.env-grid .input{height:44px;line-height:44px}

/* Tags */
.tag-sheet{margin-top:10px}
.tag-list{display:flex;gap:16px;flex-wrap:wrap}
.tag{width:300px;border:2px dashed #0f172a;border-radius:12px;padding:12px}
.tag .h{font-weight:800}
.tag .l{font-size:.9rem}

/* Signatures */
.sig-grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px;margin-bottom:80px}
.sig-box{border-top:1px solid #111;padding-top:8px;text-align:center;min-height:90px}

/* Print: only tags */
@media print{
  body *{visibility:hidden}
  .tag-sheet, .tag-sheet *{visibility:visible}
  .tag-sheet{position:absolute;left:0;top:0;width:100%}
}

/* Visibility */
.hidden{display:none !important}
