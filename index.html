<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pressure Calibration — DKD-R 6-1</title>

  <!-- Fonts & CSS -->
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="css/style.css" />

  <!-- Vendors (defer ให้โหลดหลัง DOM parsing) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js" defer></script>

  <!-- (Optional) Firebase – ถ้ายังไม่ใช้ ให้คอมเมนต์ไว้ -->
  <!--
  <script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-app-compat.js" defer></script>
  <script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-firestore-compat.js" defer></script>
  <script defer>
    const firebaseConfig = {/* TODO: ใส่ config */};
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
  </script>
  -->
</head>
<body>
  <!-- Topbar & Tabs -->
  <div class="topbar">
    <div class="container">
      <div class="top-title">
        <img src="assets/thaiBev-logo.png" alt="ThaiBev" style="height:24px;vertical-align:middle;margin-right:8px;">
        Pressure Calibration — DKD-R 6-1
      </div>
      <div class="tabs" id="nav">
        <button class="tab active" data-page="dashboard">1) Dashboard</button>
        <button class="tab" data-page="setup">2) Calibration Setup</button>
        <button class="tab" data-page="entry">3) Measurement Entry</button>
        <button class="tab" data-page="uncert">4) Uncertainty</button>
        <button class="tab" data-page="report">5) Report</button>
        <button class="tab" data-page="charts">6) Charts</button>
        <button class="tab" data-page="help">7) Guide</button>
      </div>
    </div>
  </div>

  <!-- Auth bar -->
  <header class="topbar" style="background:#0b3819;border-bottom:0;margin-bottom:8px;">
    <div class="container" style="display:flex;justify-content:space-between;align-items:center;gap:12px;">
      <div class="small" id="who" style="color:#fff;font-weight:700;">ยังไม่ได้ล็อกอิน</div>
      <div>
        <button id="btnSignIn" class="btn">Sign in with GitHub</button>
        <button id="btnSignOut" class="btn ghost hidden">Sign out</button>
      </div>
    </div>
  </header>

  <!-- ===== APP WRAPPER (ซ่อนจนกว่าจะล็อกอิน) ===== -->
  <main id="app" class="hidden">
    <!-- 1) Dashboard -->
    <div class="container" id="page-dashboard">
      <div class="card">
        <div class="row" style="justify-content:space-between">
          <div class="row" style="flex:1">
            <input id="searchText" class="input" placeholder="ค้นหา: Model / Serial / เครื่องมือ" />
            <input id="filterDateFrom" type="date" class="input"/>
            <input id="filterDateTo" type="date" class="input"/>
            <select id="filterStatus" class="input">
              <option value="">ทุกสถานะ</option>
              <option>In Progress</option><option>Completed</option><option>Pass</option><option>Fail</option>
            </select>
            <button class="btn" id="btnSearch">ค้นหา/กรอง</button>
          </div>
          <div class="row nowrap">
            <select id="factorySelect" class="input">
              <option value="">เลือกโรงงาน/ลูกค้า</option>
              <option>บริษัท อธิมาตร จำกัด</option>
              <option>บริษัท สุราบางยี่ขัน จำกัด</option>
            </select>
            <button class="btn" id="btnNew">+ สร้างงานใหม่</button>
            <button class="btn ghost" id="btnPrintTag">ออก Tag อุปกรณ์</button>
            <button class="btn warn" id="btnReset">Reset data</button>
            <button class="btn ghost" id="btnSeed">Seed demo</button>
          </div>
        </div>

        <hr class="sep"/>
        <div class="kpi-grid">
          <div class="kpi"><div class="label">จำนวนงานทั้งหมด</div><div class="n" id="kpi-total">0</div></div>
          <div class="kpi"><div class="label">กำลังดำเนินการ</div><div class="n" id="kpi-progress">0</div></div>
          <div class="kpi"><div class="label">เสร็จสิ้น</div><div class="n" id="kpi-completed">0</div></div>
          <div class="kpi"><div class="label">ผ่าน</div><div class="n" id="kpi-pass">0</div></div>
          <div class="kpi"><div class="label">ไม่ผ่าน</div><div class="n" id="kpi-fail">0</div></div>
        </div>

        <hr class="sep"/>
        <table class="table">
          <thead>
            <tr>
              <th style="width:30px"><input type="checkbox" id="chkAll"></th>
              <th>Factory</th><th>Instrument</th><th>Serial</th><th>Range</th><th>Status</th><th>Date</th><th>ผล</th><th>จัดการ</th>
            </tr>
          </thead>
          <tbody id="jobsBody"></tbody>
        </table>
      </div>

      <!-- Tags -->
      <div class="card hidden tag-sheet" id="tagArea">
        <div class="row" style="justify-content:space-between">
          <div><strong>Tag *แปะอุปกรณ์</strong> — เลือกงานในตารางแล้วกด “ออก Tag อุปกรณ์”</div>
          <div class="row">
            <button class="btn dark" onclick="window.print()">พิมพ์เฉพาะ Tag</button>
            <button class="btn ghost" id="btnCloseTag">ซ่อน</button>
          </div>
        </div>
        <hr class="sep"/>
        <div class="tag-list" id="tagList"></div>
      </div>
    </div>

    <!-- 2) Setup -->
    <div class="container hidden" id="page-setup">
      <!-- … (ส่วน Setup/Entry/Uncert/Report/Charts/Guide เหมือนของเดิมของคุณ) … -->
      <!-- ไม่ต้องแก้อะไรเพิ่มเติมใน markup ตรงนี้ -->
    </div>

    <!-- 3) Entry -->
    <div class="container hidden" id="page-entry"></div>

    <!-- 4) Uncertainty -->
    <div class="container hidden" id="page-uncert"></div>

    <!-- 5) Report -->
    <div class="container hidden" id="page-report"></div>

    <!-- 6) Charts -->
    <div class="container hidden" id="page-charts"></div>

    <!-- 7) Guide -->
    <div class="container hidden" id="page-help"></div>

    <footer class="container small">© 2025 Pressure Calibration — DKD-R 6-1</footer>
  </main>

  <!-- โหลดสคริปต์หลัก (ตัวเดียวพอ) -->
  <script type="module" src="js/app.js"></script>
  <noscript>โปรดเปิดใช้ JavaScript</noscript>
</body>
</html>
